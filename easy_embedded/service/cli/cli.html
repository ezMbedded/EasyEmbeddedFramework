<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Command Line Interface (CLI) &#8212; Easy Embedded Framework 1.0.0-0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=87e8cd4c"></script>
    <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs";





const initStyles = () => {
    const defaultStyle = document.createElement('style');
    defaultStyle.textContent = `pre.mermaid {
    /* Same as .mermaid-container > pre */
    display: block;
    width: 100%;
}

pre.mermaid > svg {
    /* Same as .mermaid-container > pre > svg */
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}`;
    document.head.appendChild(defaultStyle);

    const fullscreenStyle = document.createElement('style');
    fullscreenStyle.textContent = `.mermaid-container {
    display: flex;
    flex-direction: row;
    width: 100%;
}

.mermaid-container > pre {
    display: block;
    width: 100%;
}

.mermaid-container > pre > svg {
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}

.mermaid-fullscreen-btn {
    width: 28px;
    height: 28px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    font-size: 14px;
    line-height: 1;
    padding: 0;
    color: #333;
}

.mermaid-fullscreen-btn:hover {
    opacity: 100% !important;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    transform: scale(1.1);
}

.mermaid-fullscreen-btn.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #e0e0e0;
}

.mermaid-fullscreen-btn.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 3px 10px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal {
    display: none;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 95vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.98);
    z-index: 9999;
    padding: 20px;
    overflow: auto;
}

.mermaid-fullscreen-modal.dark-theme {
    background: rgba(0, 0, 0, 0.98);
}

.mermaid-fullscreen-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen {
    position: relative;
    width: 95vw;
    height: 90vh;
    max-width: 95vw;
    max-height: 90vh;
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen.dark-theme {
    background: #1a1a1a;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
}

.mermaid-container-fullscreen pre.mermaid {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen .mermaid svg {
    height: 100% !important;
    width: 100% !important;
    cursor: grab;
}

.mermaid-fullscreen-close {
    position: fixed !important;
    top: 20px !important;
    right: 20px !important;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    cursor: pointer;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    transition: all 0.2s;
    font-size: 24px;
    line-height: 1;
    color: #333;
}

.mermaid-fullscreen-close:hover {
    background: white;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
    transform: scale(1.1);
}

.mermaid-fullscreen-close.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #e0e0e0;
}

.mermaid-fullscreen-close.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 6px 16px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal .mermaid-fullscreen-btn {
    display: none !important;
}`;
    document.head.appendChild(fullscreenStyle);
}

// Detect if page has dark background
const isDarkTheme = () => {
    // We use a set of heuristics:
    // 1. Check for common dark mode classes or attributes
    // 2. Check computed background color brightness
    if (document.documentElement.classList.contains('dark') ||
        document.documentElement.getAttribute('data-theme') === 'dark' ||
        document.body.classList.contains('dark') ||
        document.body.getAttribute('data-theme') === 'dark') {
        // console.log("Dark theme detected via class/attribute");
        return true;
    }
    if (document.documentElement.classList.contains('light') ||
        document.documentElement.getAttribute('data-theme') === 'light' ||
        document.body.classList.contains('light') ||
        document.body.getAttribute('data-theme') === 'light') {
        // console.log("Light theme detected via class/attribute");
        return false;
    }
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        // console.log("Dark theme detected via prefers-color-scheme");
        return true;
    }
    const bgColor = window.getComputedStyle(document.body).backgroundColor;
    const match = bgColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)/);
    if (match) {
        const r = parseInt(match[1]);
        const g = parseInt(match[2]);
        const b = parseInt(match[3]);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        // console.log("Background color brightness:", brightness);
        return brightness < 128;
    }
    // console.log("No dark or light theme detected, defaulting to light theme");
    return false;
};

let darkTheme = isDarkTheme();
let modal = null;
let modalContent = null;
let previousScrollOffset = [window.scrollX, window.scrollY];

const runMermaid = async (rerun) => {
    console.log("Running mermaid diagrams, rerun =", rerun);
    // clear all existing mermaid charts
    let all_mermaids = document.querySelectorAll(".mermaid");

    if (rerun) {
        all_mermaids.forEach((el) => {
            if(!el.hasAttribute("data-original-code")) {
                // store original code
                // console.log(`Storing original code for first run: `, el.innerHTML);
                el.setAttribute('data-original-code', el.innerHTML);
            }
            if(el.getAttribute("data-processed") === "true") {
                // remove and restore original
                el.removeAttribute("data-processed");
                // console.log(`Restoring original code for re-run: `, el.getAttribute('data-original-code'));
                el.innerHTML = el.getAttribute('data-original-code');
            } else {
                // store original code
                // console.log(`Storing original code for re-run: `, el.innerHTML);
                el.setAttribute('data-original-code', el.innerHTML);
            }
        });
        await mermaid.run();
    }

    all_mermaids = document.querySelectorAll(".mermaid");
    const mermaids_processed = document.querySelectorAll(".mermaid[data-processed='true']");

    if ("False" === "True") {
        const mermaids_to_add_zoom = -1 === -1 ? all_mermaids.length : -1;
        if(mermaids_to_add_zoom > 0) {
            var svgs = d3.selectAll("");
            if(all_mermaids.length !== mermaids_processed.length) {
                setTimeout(() => runMermaid(false), 200);
                return;
            } else if(svgs.size() !== mermaids_to_add_zoom) {
                setTimeout(() => runMermaid(false), 200);
                return;
            } else {
                svgs.each(function() {
                    var svg = d3.select(this);
                    svg.html("<g class='wrapper'>" + svg.html() + "</g>");
                    var inner = svg.select("g");
                    var zoom = d3.zoom().on("zoom", function(event) {
                        inner.attr("transform", event.transform);
                    });
                    svg.call(zoom);
                });
            }
        }
    } else if(all_mermaids.length !== mermaids_processed.length) {
        // Wait for mermaid to process all diagrams
        setTimeout(() => runMermaid(false), 200);
        return;
    }

    // Stop here if not adding fullscreen capability
    if ("True" !== "True") return;

    if (modal !== null ) {
        // Destroy existing modal
        modal.remove();
        modal = null;
        modalContent = null;
    }

    modal = document.createElement('div');
    modal.className = 'mermaid-fullscreen-modal' + (darkTheme ? ' dark-theme' : '');
    modal.setAttribute('role', 'dialog');
    modal.setAttribute('aria-modal', 'true');
    modal.setAttribute('aria-label', 'Fullscreen diagram viewer');
    modal.innerHTML = `
        <button class="mermaid-fullscreen-close${darkTheme ? ' dark-theme' : ''}" aria-label="Close fullscreen">✕</button>
        <div class="mermaid-container-fullscreen${darkTheme ? ' dark-theme' : ''}"></div>
    `;
    document.body.appendChild(modal);

    modalContent = modal.querySelector('.mermaid-container-fullscreen');
    const closeBtn = modal.querySelector('.mermaid-fullscreen-close');

    const closeModal = () => {
        modal.classList.remove('active');
        modalContent.innerHTML = '';
        document.body.style.overflow = ''
        window.scrollTo({left: previousScrollOffset[0], top: previousScrollOffset[1], behavior: 'instant'});
    };

    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
            closeModal();
        }
    });

    document.querySelectorAll('.mermaid').forEach((mermaidDiv) => {
        if (mermaidDiv.parentNode.classList.contains('mermaid-container') ||
            mermaidDiv.closest('.mermaid-fullscreen-modal')) {
            // Already processed, adjust button class if needed
            const existingBtn = mermaidDiv.parentNode.querySelector('.mermaid-fullscreen-btn');
            if (existingBtn) {
                existingBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
            }
            return;
        }

        const container = document.createElement('div');
        container.className = 'mermaid-container';
        mermaidDiv.parentNode.insertBefore(container, mermaidDiv);
        container.appendChild(mermaidDiv);

        const fullscreenBtn = document.createElement('button');
        fullscreenBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
        fullscreenBtn.setAttribute('aria-label', 'View diagram in fullscreen');
        fullscreenBtn.textContent = '⛶';
        fullscreenBtn.style.opacity = '50%';

        // Calculate dynamic position based on diagram's margin and padding
        const diagramStyle = window.getComputedStyle(mermaidDiv);
        const marginTop = parseFloat(diagramStyle.marginTop) || 0;
        const marginRight = parseFloat(diagramStyle.marginRight) || 0;
        const paddingTop = parseFloat(diagramStyle.paddingTop) || 0;
        const paddingRight = parseFloat(diagramStyle.paddingRight) || 0;
        fullscreenBtn.style.top = `${marginTop + paddingTop + 4}px`;
        fullscreenBtn.style.right = `${marginRight + paddingRight + 4}px`;

        fullscreenBtn.addEventListener('click', () => {
            previousScrollOffset = [window.scroll, window.scrollY];
            const clone = mermaidDiv.cloneNode(true);
            modalContent.innerHTML = '';
            modalContent.appendChild(clone);

            const svg = clone.querySelector('svg');
            if (svg) {
                svg.removeAttribute('width');
                svg.removeAttribute('height');
                svg.style.width = '100%';
                svg.style.height = 'auto';
                svg.style.maxWidth = '100%';
                svg.style.sdisplay = 'block';

                if ("False" === "True") {
                    setTimeout(() => {
                        const g = svg.querySelector('g');
                        if (g) {
                            var svgD3 = d3.select(svg);
                            svgD3.html("<g class='wrapper'>" + svgD3.html() + "</g>");
                            var inner = svgD3.select("g");
                            var zoom = d3.zoom().on("zoom", function(event) {
                                inner.attr("transform", event.transform);
                            });
                            svgD3.call(zoom);
                        }
                    }, 100);
                }
            }

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });
        container.appendChild(fullscreenBtn);
    });
};

const load = async () => {
    initStyles();

    await runMermaid(true);

    const reRunIfThemeChanges = async () => {
        const newDarkTheme = isDarkTheme();
        if (newDarkTheme !== darkTheme) {
            darkTheme = newDarkTheme;
            console.log("Theme change detected, re-running mermaid with", darkTheme ? "dark" : "default", "theme");
            await mermaid.initialize(
                {...JSON.parse(
                    `{"startOnLoad": false}`
                ),
                ...{ darkMode: darkTheme, theme: darkTheme ? 'dark' : 'default' },
                }
            );
            await runMermaid(true);
        }
    };

    // Update theme classes when theme changes
    const themeObserver = new MutationObserver(reRunIfThemeChanges);
    themeObserver.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
    themeObserver.observe(document.body, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
};





console.log("Initializing mermaid with", darkTheme ? "dark" : "default", "theme");
mermaid.initialize(
    {...JSON.parse(
        `{"startOnLoad": false}`
    ),
    ...{ darkMode: darkTheme, theme: darkTheme ? 'dark' : 'default' },
    }
);

window.addEventListener("load", load);</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Data Model" href="../data_model/data_model.html" />
    <link rel="prev" title="EasyEmbedded Framework Architecture" href="../../../system_architecture.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="command-line-interface-cli">
<h1>Command Line Interface (CLI)<a class="headerlink" href="#command-line-interface-cli" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>This document describes the architecture of the Command Line Interface (CLI) component.
The CLI provides a simple, extensible interface for interacting with embedded applications via text commands.
It parses commands, arguments, and values, dispatches them to registered handlers, and returns responses.
The CLI is not responsible for transport (UART, USB, etc.) or command implementation logic.</p>
<p>Use cases:</p>
<ul class="simple">
<li><p>Debugging and testing embedded systems</p></li>
<li><p>Configuring device parameters at runtime</p></li>
<li><p>Providing a user interface for headless devices</p></li>
</ul>
</section>
<section id="component-structure">
<h2>Component Structure<a class="headerlink" href="#component-structure" title="Link to this heading">¶</a></h2>
<p>The CLI component is composed of the following sub-components:</p>
<ul class="simple">
<li><p><strong>ezCli_t</strong>: Main CLI instance, holds state, buffers, and interfaces.</p></li>
<li><p><strong>ezCliCmdList_t</strong>: List of supported commands.</p></li>
<li><p><strong>ezCliCommand_t</strong>: Definition of a single command, its arguments, and callback.</p></li>
<li><p><strong>ezCliBuff_t</strong>: Buffer for incoming command text.</p></li>
<li><p><strong>ezCliInterface_t</strong>: Abstraction for receiving and sending characters.</p></li>
</ul>
<pre align="center" class="mermaid align-center">
        graph TD
   A[ezCli_t (CLI Instance)]
   B[ezCliCmdList_t (Command List)]
   C[ezCliCommand_t (Command)]
   D[ezCliBuff_t (Buffer)]
   E[ezCliInterface_t (I/O Interface)]
   A --&gt; B
   B --&gt; C
   A --&gt; D
   A --&gt; E
    </pre></section>
<section id="component-behavior">
<h2>Component Behavior<a class="headerlink" href="#component-behavior" title="Link to this heading">¶</a></h2>
<section id="external-behavior">
<h3>External Behavior<a class="headerlink" href="#external-behavior" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Receives characters via <cite>GetCharCallback</cite>.</p></li>
<li><p>Parses input into commands, arguments, and values.</p></li>
<li><p>Matches input to registered commands.</p></li>
<li><p>Executes the corresponding callback.</p></li>
<li><p>Sends responses via <cite>SendCharsCallback</cite>.</p></li>
</ul>
</section>
<section id="internal-behavior">
<h3>Internal Behavior<a class="headerlink" href="#internal-behavior" title="Link to this heading">¶</a></h3>
<p>The CLI uses a state machine with the following states:</p>
<ul class="simple">
<li><p><strong>STATE_COMMAND</strong>: Parsing the command name.</p></li>
<li><p><strong>STATE_ARGUMENT</strong>: Parsing command arguments.</p></li>
<li><p><strong>STATE_VALUE</strong>: Parsing argument values (supports quoted strings).</p></li>
<li><p><strong>STATE_ERROR</strong>: Handles errors and resets state.</p></li>
</ul>
<p>Transitions occur based on received characters (space, newline, etc.) and parsing progress.</p>
<pre align="center" class="mermaid align-center">
        stateDiagram-v2
   [*] --&gt; STATE_COMMAND : Reset/Start
   STATE_COMMAND --&gt; STATE_ARGUMENT : Command with argument detected
   STATE_COMMAND --&gt; STATE_ERROR : Unknown command / Error
   STATE_COMMAND --&gt; STATE_COMMAND : Command without argument (loop)
   STATE_ARGUMENT --&gt; STATE_VALUE : Argument with value detected
   STATE_ARGUMENT --&gt; STATE_COMMAND : End of line (no value)
   STATE_ARGUMENT --&gt; STATE_ERROR : Invalid argument
   STATE_VALUE --&gt; STATE_ARGUMENT : Value parsed, next argument
   STATE_VALUE --&gt; STATE_COMMAND : End of line (all values parsed)
   STATE_VALUE --&gt; STATE_ERROR : Value parse error
   STATE_ERROR --&gt; STATE_COMMAND : On reset/newline
    </pre></section>
</section>
<section id="component-data-types">
<h2>Component Data Types<a class="headerlink" href="#component-data-types" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>ezCli_t</strong>: Main CLI context (state, buffers, command list, etc.)</p></li>
<li><p><strong>ezCliCmdList_t</strong>: Array of <cite>ezCliCommand_t</cite> and count.</p></li>
<li><p><strong>ezCliCommand_t</strong>: Command name, description, argument lists, callback.</p></li>
<li><p><strong>ezCliBuff_t</strong>: Buffer pointer, size, current index.</p></li>
<li><p><strong>ezCliInterface_t</strong>: Function pointers for input/output.</p></li>
<li><p><strong>CLI_NOTIFY_CODE</strong>: Return codes for command execution (OK, ERR, BAD_ARG).</p></li>
<li><p><strong>CLI_STATE</strong>: State machine states.</p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Easy Embedded Framework</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">System:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../system_overview.html">EasyEmbedded Framework Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../system_architecture.html">EasyEmbedded Framework Architecture</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Service:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Command Line Interface (CLI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_model/data_model.html">Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ipc/ipc.html">Interprocess Communication (IPC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpc/rpc.html">Remote Procedure Call (RPC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../driver/driver.html">Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../event_bus/event_bus.html">Event Bus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../state_machine/state_machine.html">State Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_worker/task_worker.html">Task Worker</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Middlewares:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../middlewares/osal/osal.html">Operating System Abstraction Layer (OSAL)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../utilities/assert/assert.html">Assert</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities/hexdump/hexdump.html">Hexdump</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities/linked_list/linked_list.html">Linked List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities/logging/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities/queue/queue.html">Queue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities/ring_buffer/ring_buffer.html">Ring Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities/static_alloc/static_alloc.html">Static Allocation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../../../system_architecture.html" title="previous chapter">EasyEmbedded Framework Architecture</a></li>
      <li>Next: <a href="../data_model/data_model.html" title="next chapter">Data Model</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2026, Hai Nguyen.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.1.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../_sources/easy_embedded/service/cli/cli.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>